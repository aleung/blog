<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/blog/css/main.css">


<link rel="stylesheet" href="/blog/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"aleung.github.io","root":"/blog/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":3,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="在今年初推出的Google Map for Mobile新版本中提供了称为My Location的功能，不需要GPS的支持，也能在地图上显示出当前手机所在的位置。这个功能着实让人眼前一亮。虽然移动网络本身就可以提供定位的能力，但是Google的My Location并不依赖于移动网络定位能力，完全绕开了运营商的控制。 My Location是怎样实现的呢？Google网站上介绍了大致的原理：手机接">
<meta property="og:type" content="article">
<meta property="og:title" content="How does Google Map My Location work?">
<meta property="og:url" content="http://aleung.github.io/blog/2008/05/11/How-does-Google-Map-My-Location-work-/index.html">
<meta property="og:site_name" content="Good good study, day day up">
<meta property="og:description" content="在今年初推出的Google Map for Mobile新版本中提供了称为My Location的功能，不需要GPS的支持，也能在地图上显示出当前手机所在的位置。这个功能着实让人眼前一亮。虽然移动网络本身就可以提供定位的能力，但是Google的My Location并不依赖于移动网络定位能力，完全绕开了运营商的控制。 My Location是怎样实现的呢？Google网站上介绍了大致的原理：手机接">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2008-05-11T00:22:00.000Z">
<meta property="article:modified_time" content="2022-12-07T16:53:24.580Z">
<meta property="article:author" content="Leo Liang">
<meta property="article:tag" content="GPS_GIS">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://aleung.github.io/blog/2008/05/11/How-does-Google-Map-My-Location-work-/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>How does Google Map My Location work? | Good good study, day day up</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/blog/atom.xml" title="Good good study, day day up" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/blog/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Good good study, day day up</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">aleung的学习笔记, aleung的idea</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/blog/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/blog/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">53</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/blog/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">335</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://aleung.github.io/blog/2008/05/11/How-does-Google-Map-My-Location-work-/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars.io/gravatar/leoliang@gmail.com">
      <meta itemprop="name" content="Leo Liang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Good good study, day day up">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          How does Google Map My Location work?
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2008-05-11 08:22:00" itemprop="dateCreated datePublished" datetime="2008-05-11T08:22:00+08:00">2008-05-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-12-08 00:53:24" itemprop="dateModified" datetime="2022-12-08T00:53:24+08:00">2022-12-08</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>在今年初推出的<a target="_blank" rel="noopener" href="http://www.google.com/mobile/gmm/index.html">Google Map for Mobile</a>新版本中提供了称为My Location的功能，不需要GPS的支持，也能在地图上显示出当前手机所在的位置。这个功能着实让人眼前一亮。虽然移动网络本身就可以提供定位的能力，但是Google的My Location并不依赖于移动网络定位能力，完全绕开了运营商的控制。</p>
<p>My Location是怎样实现的呢？Google网站上介绍了大致的<a target="_blank" rel="noopener" href="http://www.google.com/mobile/gmm/mylocation/index.html">原理</a>：手机接收到移动基站的信号，根据基站的信息可以知道当前处于哪个基站的信号覆盖范围，如果基站的位置是已知的，就可以确定当前的大概位置了。</p>
<p>具体点说，这是一种叫做Cell-Id Positioning Method的技术。GSM网络（3G网络也一样）覆盖由Location Area组成，（Location Area是指mobile terminal可以任意移动而不需要进行location update的区域）。Location Area由LAI（Location Area Id）来标识，LAI由MCC，MNC，LAC组成。其中MCC是3位的Mobile Country Code，中国为460；MNC是2位Mobile Network Code，在国家内分配，中国移动为00；LAC为Location Area Code，在network内分配；可见LAI是全世界唯一的。在一个location area中设置一个或多个基站，基站天线的信号覆盖一定的区域，称为cell（小区）；根据天线的不同，每个基站可能包含1个或多个cell，定向天线的信号覆盖一个扇形范围，多个天线的扇区为不同的cell。每个cell有自己的Cell-Id，结合LAI和Cell-Id，就可以在全球范围内唯一确定一个cell。要进行定位，需要有一个cell坐标数据库，根据cell-id来查找位置信息。</p>
<p>Google的My Location表示格式为myl:MCC:MNC:LAC:CI。在Google Map for Mobile的about信息末尾可以看到。如果显示为myl:n&#x2F;a，那就是手机不能提供cell-id信息。很不幸，我正在用的SonyEricsson w810c就不支持:(</p>
<p>下一个问题就是cell坐标数据是怎么来的？移动网络运营商提供，不是太现实。Google不可能与全球所有的运营商达成协议。特别是在中国，凡是涉及精确地理坐标的数据都属于机密范畴，然而我们发现My Location在广州是可用的，估计其他城市也可以。于是我猜Google是自己采集这些信息的，例如开辆车周围转，记录各处的cell-id。但有点奇怪的是，在广州我们发现在天河软件园得到的位置比较准确，但是在其他地方的就误差很大，并且表示精确度范围的圆圈半径非常大，将半个天河区都包含在内。难道Google只在天河软件园采集了数据，而其他地方没有？</p>
<p>最近，一个同事开发了一个程序，利用手机自带的GPS定位，将cell-id与坐标记录下来。我们讨论的时候才恍然大悟，Google很可能就是这样做的！有些Google Map for Mobile用户的手机是支持GPS的，当这些用户运行Google Map时打开了GPS，坐标数据以及cell-id就会发送到Google的服务器，等于有许多用户在替Google采集数据。在天河软件园的定位准确，就因为我们（当然也可能有其他人）在这里试验Google Map时打开过GPS。在我们这里，支持GPS的手机的拥有率不高，同时又使用Google Map的更少，因此Google掌握到的数据很有限。在没有采集到数据的地方，定位就不准确了。</p>
<p>为了求证，到Google网站上查看，在GoogleMobile的Privacy Policy中找到这样一段话：<em>If you use location-based products and services, such as Google Maps for mobile, you may be sending us location information. This information may reveal your actual location, such as GPS data, or it may not, such as when you submit a partial address to look at a map of the area</em>. 在help中又找到一段话：<em>Google takes geo-contextual information [from anonymous GPS-readings, etc] and associates this information with the cell at that location to develop a database of cell locations</em>. 看来我们的猜想是成立的。其实还可以通过做实验来证明：找一台支持GPS的手机，到一个定位有非常大误差的地方，在Google Map中enable GPS。过一段时间后，例如几天，因为Google处理数据可能有延迟，在关闭GPS的状态下看My Location，如果定位变得准确了就是Google使用了用户手机GPS采集的数据。不过我没有GPS手机，无法做这个实验。</p>
<p>在网上查找资料的过程中发现，其实Cell-id定位并不是一项新技术，不过它与Google Map的海量高清晰度地图结合起来，给业界带来了震撼。在Treo智能手机上，2006年就有国内的爱好者开发了<a target="_blank" rel="noopener" href="http://www.palm119.net/blogview.asp?logID=42">手机定位软件</a>，根据cell-id查询到当前位置，不过位置信息是地名，而不是经纬度坐标；Cell-Id对照地名信息的数据库是由用户补充完善的。在网上搜索一下，也可以找到好几个开放的cell-id坐标数据库，例如<a target="_blank" rel="noopener" href="http://www.opencellid.org/">OpenCellID</a>，只不过几乎都没有中国大陆的数据。Flickr为了配合ZoneTag（用手机拍照时记录下cell-id，从而可以知道照片拍摄的位置），还提供了<a target="_blank" rel="noopener" href="http://developer.yahoo.com/yrb/zonetag/locatecell.html">Cell Location API</a>。</p>

    </div>

    
    
    

      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/blog/tags/GPS-GIS/" rel="tag"><i class="fa fa-tag"></i> GPS_GIS</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/blog/2008/04/15/Linux-cut-/" rel="prev" title="Linux的cut命令">
      <i class="fa fa-chevron-left"></i> Linux的cut命令
    </a></div>
      <div class="post-nav-item">
    <a href="/blog/2008/05/13/Wenchuan-county-sichuan-M7-8-earthquake-happened/" rel="next" title="四川汶川县发生M7.8级地震">
      四川汶川县发生M7.8级地震 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Leo Liang"
      src="https://avatars.io/gravatar/leoliang@gmail.com">
  <p class="site-author-name" itemprop="name">Leo Liang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/blog/archives/">
        
          <span class="site-state-item-count">335</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/blog/tags/">
          
        <span class="site-state-item-count">53</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2001 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Leo Liang</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/blog/lib/anime.min.js"></script>
  <script src="/blog/lib/velocity/velocity.min.js"></script>
  <script src="/blog/lib/velocity/velocity.ui.min.js"></script>

<script src="/blog/js/utils.js"></script>

<script src="/blog/js/motion.js"></script>


<script src="/blog/js/schemes/pisces.js"></script>


<script src="/blog/js/next-boot.js"></script>




  




  
<script src="/blog/js/local-search.js"></script>













  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : '578b819466ead4247b6e',
      clientSecret: '6a36866b9ae12bc5b0b1f0df95c98cbb2ed7ef61',
      repo        : 'blog-comments',
      owner       : 'aleung',
      admin       : ['aleung'],
      id          : 'afd7081809a4198cf794aa5cb6e7893b',
        language: '',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

</body>
</html>
