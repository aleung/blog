---
title: K2G 无线路由器
date: 2022-10-09 23:26:46
tags:
---

捡到一个斐信K2G无线路由器，上电连接192.168.2.1进入管理界面，发现需要密码，长按后面按钮10秒重置系统，恢复出厂设置。路由器前面只有一盏灯，红色是正在启动，变成橙色是启动完成。

管理界面的路径包含`/cgi-bin/luci`，这个路由器的固件应该是基于OpenWRT的。翻了一下菜单，功能不多，看到网上说这个路由器刷机资源挺丰富的，试一试。

这个路由器硬件是K2G A1版本，固件版本号为22.6.3.20，芯片方案 MT7620A+MT7612EN，64M内存，8MB闪存。

## 刷机步骤

首先刷breed（bootloader），步骤：

1. 从<https://breed.hackpascal.net>下载breed包([breed-mt7620-phicomm-psg1208.bin](./breed-mt7620-phicomm-psg1208.bin))到本地电脑。

1. 在电脑上运行一个 http server，供下载breed安装包 (例如 `npx http-server ~/Download/`)

1. 电脑用网线连接路由器. 运行`ip a`确认一下分配到的IP地址，后面路由器要连接这个IP来下载breed安装包

1. 进入路由器管理界面（http://192.168.2.1）：高级设置-系统设置-自动升级-自定义升级时间，从下拉菜单中选择5分钟；按F12打开浏览器开发工具，定位到这个菜单项的HTML，将`value`修改为`05 | /usr/sbin/telnetd -l /bin/login.sh`(注入漏洞)；选择一下其他分钟数，再点回来，确认value内的值没有丢失。然后点击web界面上的保存按钮

1. 这时，telnetd应该就运行了。Telnet到192.168.2.1，应该能够进入shell

1. 在shell里面执行:
    ```
    cd /tmp
    wget http://192.168.2.229:8080/breed-mt7620-phicomm-psg1208.bin
    mtd unlock Bootloader
    mtd -r write breed-mt7620-phicomm-psg1208.bin Bootloader
    ```
    
1. 等待路由器重启，breed就已经被刷入

进入breed web界面的方法：
1. 持续按住路由器上的reset按钮，接通路由器电源，待路由器上电后3-5秒后松开reset按钮，进入bootloader（指示灯会一直红色）
1. 浏览器访问 http://192.168.1.1
1. 上面可以进行固件备份、固件安装等操作。安装固件和恢复出厂配置时需要选择闪存布局/固件类型为"Config区(公版)"。
1. 开刷前，请必须记得先「恢复出厂设置」->「Config 区 (公版)」，然后点「执行」

来源：<https://www.right.com.cn/FORUM/thread-325866-1-1.html>

## 固件

然后下一步刷固件，网上搜索发现2020年之后没有人玩这款路由器了，后面没有什么更新，固件都是之前的。

### Padavan（老毛子）固件

Padavan是俄罗斯（老毛子）大神改自华硕路由器系统。网上的Padavan固件基本上都没有提供K2G的版本，只找到这个提供了K2G：<https://www.right.com.cn/forum/thread-4000461-1-1.html>

其中纯净版可以正常使用，但标准版固件有问题，重新启动或恢复出厂设置无法启动路由器。

### Pandorabox 潘多拉固件

Pandorabox 基于 OpenWRT 修改而来，和 OpenWRT 几乎拥有一样的优缺点，但无线驱动比openwrt的开源驱动好很多。

- 胜在丰富的插件和自由的固件定制
- 使用复杂

忘记有没有找到K2G能用的了，反正最后用的是上面那个Padavan纯净版，没有什么插件，作为一个路由器够用了。

## 使用

书房里的wifi信号不是太好，但又拉不了网线进房间。台式电脑放在书房里，另外又装了台NAS，如果都走无线就太慢了。尝试使用这个K2G作为无线中继，在房间中的设备用网线连上这个中继，效果还可以，速度比电脑自己的无线网卡好。

Padavan的无线设置里选择无线桥接，工作模式选择“AP-Client + AP“，这时这个无线接口充当另外一个AP的客户端，配置上级AP的SSID和认证密码，就像一个客户端设备一样连上；同时这个无线接口还是一个AP，可以为其他设备提供接入，跟上级AP同一个子网，DHCP也是由上级路由器提供。

如果不需要为其他无线设备提供接入，只用网线，也可以选择工作模式为 “AP-Client“ only，按理说性能会好些，不过我试了一下同时充当AP速度也没有什么区别。

无线桥接中的工作模式选择还有 “WDS桥接“ 和 ”WDS中继“ 两种，好像是说要求上下级的路由器的芯片系列相同才行。先试的是WDS模式但没有成功，AP-Client模式能用也就不深究了。